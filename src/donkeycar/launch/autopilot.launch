<launch>
    <include file="$(find donkeycar)/launch/drive.launch"/>

    <env name="GSCAM_CONFIG" value="nvarguscamerasrc ! video/x-raw(memory:NVMM), width=1280, height=720, format=NV12, framerate=30/1 ! nvvidconv flip-method=6 ! nvvidconv ! video/x-raw, width=224, height=224, format=BGRx ! videoconvert " />

    <node pkg="gscam" type="gscam" name="camera">
        <param name="image_encoding" value="mono8"/>
    </node>

    <node pkg="controller" type="nn_controller_node" name="nn_controller_node" output="screen">
        <param name="steer_ratio" value="-1"/>
        <param name="backend" value="tensorrt"/>
        
        <param name="model_file" value="$(find donkeycar)/models/0206.onnx"/>
        <param name="roi/x" value="0"/>
        <param name="roi/y" value="80"/>
        <param name="roi/width" value="224"/>
        <param name="roi/height" value="144"/>
        <param name="input_name" value="img_in:0"/>
        <param name="output_name" value="Identity:0"/>

        <remap from="/nn_controller_node/image_raw" to="/camera/image_raw" />
    </node>

    <!-- <node pkg="controller" type="nn_controller_node" name="nn_controller_node" output="screen">
        <param name="steer_ratio" value="1"/>
        <param name="backend" value="tensorflow"/>
        <param name="model_file" value="$(find donkeycar)/models/0206"/>
        <param name="roi/x" value="0"/>
        <param name="roi/y" value="80"/>
        <param name="roi/width" value="224"/>
        <param name="roi/height" value="144"/>
        <param name="to_grayscale" value="true"/>
        <param name="input_name" value="img_in"/>

        <remap from="/nn_controller_node/image_raw" to="/camera/image_raw" />
    </node> -->
</launch>
