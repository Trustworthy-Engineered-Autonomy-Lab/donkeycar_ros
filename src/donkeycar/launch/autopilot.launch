<launch>
    <include file="$(find donkeycar)/launch/drive.launch"/>

    <env name="GSCAM_CONFIG" value="nvarguscamerasrc 
                                    ! video/x-raw(memory:NVMM), width=3280, height=2464, format=NV12, framerate=21/1 
                                    ! nvvidconv flip-method=2
                                    ! video/x-raw, width=224, height=224, format=BGRx
                                    ! videocrop left=0 right=0 top=80 bottom=0
                                    ! videoconvert " />

    <node pkg="gscam" type="gscam" name="camera">
    </node>

    <node pkg="controller" type="nn_controller_node" name="nn_controller_node" output="screen">
        <param name="steer_ratio" value="-1"/>
        <param name="backend" value="tensorrt"/>
        
        <param name="model_file" value="$(find donkeycar)/models/best.onnx"/>
        <param name="input_name" value="image"/>
        <param name="output_name" value="steer"/>

        <remap from="/nn_controller_node/image_raw" to="/camera/image_raw" />
    </node>

    <!-- <node pkg="controller" type="nn_controller_node" name="nn_controller_node" output="screen">
        <param name="steer_ratio" value="1"/>
        <param name="backend" value="tensorflow"/>
        <param name="model_file" value="$(find donkeycar)/models/0206"/>
        <param name="roi/x" value="0"/>
        <param name="roi/y" value="80"/>
        <param name="roi/width" value="224"/>
        <param name="roi/height" value="144"/>
        <param name="to_grayscale" value="true"/>
        <param name="input_name" value="img_in"/>

        <remap from="/nn_controller_node/image_raw" to="/camera/image_raw" />
    </node> -->
</launch>
